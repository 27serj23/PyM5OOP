# 3.2
# –¢–µ–ø–µ—Ä—å —É –≤–æ–∏–Ω–æ–≤ –µ—Å—Ç—å 2 –º–µ—Ç–æ–¥–∞. –ó–∞—â–∏—â–∞—Ç—å—Å—è –∏ –∞—Ç–∞–∫–æ–≤–∞—Ç—å. –ï—Å—Ç—å –æ—á–∫–∏
# –∑–¥–æ—Ä–æ–≤—å—è, –æ—á–∫–∏ –±—Ä–æ–Ω–∏ –∏ –æ—á–∫–∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏.
# –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∫–∞–∂–¥—ã–π –≤–æ–∏–Ω –∞—Ç–∞–∫—É–µ—Ç –∏–ª–∏ –∑–∞—â–∏—â–∞–µ—Ç—Å—è. –ö–æ–≥–¥–∞
# –≤–æ–∏–Ω –∞—Ç–∞–∫—É–µ—Ç, –æ–Ω —Ç–µ—Ä—è–µ—Ç 10 –æ—á–∫–æ–≤ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏. –ö–æ–≥–¥–∞ –≤–æ–∏–Ω
# –∑–∞—â–∏—â–∞–µ—Ç—Å—è, –∞ –µ–≥–æ –∞—Ç–∞–∫—É—é—Ç, –æ–Ω —Ç–µ—Ä—è–µ—Ç –æ—á–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è(random(0, 20))
# –∏ –æ—á–∫–∏ –±—Ä–æ–Ω–∏(random(0, 10)).–ö–æ–≥–¥–∞ –æ–±–∞ –≤–æ–∏–Ω–∞ –∞—Ç–∞–∫—É—é—Ç, –æ–Ω–∏ –æ–±–∞
# —Ç–µ—Ä—è—é—Ç –æ—á–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è(random(10, 30)) –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏. –ï—Å–ª–∏ –æ–±–∞
# –≤–æ–∏–Ω–∞ –∑–∞—â–∏—â–∞—é—Ç—Å—è, –æ–Ω–∏ –Ω–µ —Ç–µ—Ä—è—é—Ç –æ—á–∫–æ–≤. –ö–æ–≥–¥–∞ –æ—á–∫–∏ –±—Ä–æ–Ω–∏ –∫–æ–Ω—á–∞—é—Ç—Å—è, –∑–∞—â–∏—â–∞—é—â–∏–π—Å—è –≤–æ–∏–Ω
# —Ç–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ—á–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è(random(10, 30)). –ö–æ–≥–¥–∞ –æ—á–∫–∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏
# –∑–∞–∫–æ–Ω—á–∞—Ç—Å—è, –≤–æ–∏–Ω –Ω–∞–Ω–æ—Å–∏—Ç –º–µ–Ω—å—à–µ —É—Ä–æ–Ω–∞ random(0, 10).
# –ù–∞ –∫–∞–∂–¥–æ–º —Ö–æ–¥–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞—â–∏—â–∞—Ç—å—Å—è –∏–ª–∏ –∞—Ç–∞–∫–æ–≤–∞—Ç—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.
# –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç —Ç–æ—Ç –≤–æ–∏–Ω, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–µ—Ä–≤—ã–º –æ—Å—Ç–∞–ª–æ—Å—å 10 –µ–¥–∏–Ω–∏—Ü –∑–¥–æ—Ä–æ–≤—å—è.
# –¢–æ–≥–¥–∞(–∫–∞–∫ –≤ –ö–æ–ª–∏–∑–µ–µ) —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç —É–±–∏—Ç—å –µ–≥–æ, –∏–ª–∏ (–Ω–µ—Ç.polliceverso)
# –ü—Ä–∏–º–µ—Ä: health = 100
# —É –æ–±–æ–∏—Ö
# health_1 - –∑–¥–æ—Ä–æ–≤—å–µ –ø–µ—Ä–≤–æ–≥–æ
# health_2 - –∑–¥–æ—Ä–æ–≤—å–µ –≤—Ç–æ—Ä–æ–≥–æ
# endurance = 100 - –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å
# —É –æ–±–æ–∏—Ö
# end_1- –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –ø–µ—Ä–≤–æ–≥–æ
# end_2 - –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ
# armor = 100 - –±—Ä–æ–Ω—è
# —É –æ–±–æ–∏—Ö armor_1-–±—Ä–æ–Ω—è —É –ø–µ—Ä–≤–æ–≥–æ
# armor_2-–±—Ä–æ–Ω—è —É –≤—Ç–æ—Ä–æ–≥–æ
# 1: –∞—Ç–∞–∫–∞
# 2: –∞—Ç–∞–∫–∞
# health_1 -= random(10, 30)
# health_2 -= random(10, 30)
# end_1 -= 10
# end_2 -= 10
# 1: –∞—Ç–∞–∫–∞
# 2: –∑–∞—â–∏—Ç–∞
# end_1 -= 10
# health_2 -= random(0, 20)
# armor_2 -= random(0, 10)
import random
from typing import List, Tuple

class Warrior:
    def __init__(self, name: str, health: int = 100, endurance: int = 100, armor: int = 100):# –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–º—è –∏—Ç–¥
        self.name = name
        self.health = health
        self.endurance = endurance
        self.armor = armor
        self._is_defending = False

    def is_alive(self) -> bool: # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º True, –ø–æ–∫–∞ –∑–¥–æ—Ä–æ–≤—å–µ –±–æ–ª—å—à–µ 10
        return self.health > 10

    def attack(self) -> Tuple[bool, int, str]: # –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º –∞—Ç–∞–∫—É, –≥–µ–Ω–µ—Ä–∏—Ä—É—è —Å–ª—É—á–∞–π–Ω—ã–π —É—Ä–æ–Ω –∏ —Å–Ω–∏–∂–∞—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å
        if self.endurance < 10:
            damage = random.randint(0, 10)
            return True, damage, f"{self.name} –∞—Ç–∞–∫—É–µ—Ç —Å –ø–æ–Ω–∏–∂–µ–Ω–Ω—ã–º —É—Ä–æ–Ω–æ–º –∏–∑-–∑–∞ —É—Å—Ç–∞–ª–æ—Å—Ç–∏ (—É—Ä–æ–Ω: {damage})"
        self.endurance -= 10 # –ó–∞—â–∏—Ç–∞
        damage = self.get_attack_damage()
        return True, damage, f"{self.name} –∞—Ç–∞–∫–æ–≤–∞–ª (—É—Ä–æ–Ω: {damage})"

    def defend(self) -> str: # –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º –∑–∞—â–∏—Ç—ã, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—â–µ—Ä–±
        self._is_defending = True
        return f"{self.name} –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º –∑–∞—â–∏—Ç—ã"

    def take_damage(self, damage: int, attacker_action: str) -> str:# –≤—ã—á–∏—Å–ª—è–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –Ω–∞–Ω–æ—Å–∏–º—ã–π —É—Ä–æ–Ω
        health_damage = 0
        armor_damage = 0
        if attacker_action == 'attack':
            if self._is_defending:
                if self.armor > 0:
                    health_damage = random.randint(0, 20)
                    armor_damage = random.randint(0, 10)
                    self.armor -= armor_damage
                    if self.armor < 0:
                        self.armor = 0
                else:
                    health_damage = random.randint(10, 30)
            else:
                health_damage = random.randint(10, 30)
        else:
            health_damage = damage

        self.health -= health_damage
        if armor_damage > 0:
            return f"–ø–æ–ª—É—á–∏–ª {health_damage} —É—Ä–æ–Ω–∞ –ø–æ –∑–¥–æ—Ä–æ–≤—å—é (–±—Ä–æ–Ω—è –ø–æ–≥–ª–æ—Ç–∏–ª–∞ {armor_damage})"
        else:
            return f"–ø–æ–ª—É—á–∏–ª {health_damage} —É—Ä–æ–Ω–∞ –ø–æ –∑–¥–æ—Ä–æ–≤—å—é"
# –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
    def get_attack_damage(self) -> int: # —Ä–∞—Å—á–µ—Ç —É—Ä–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏
        if self.endurance <= 0:
            return random.randint(0, 10)
        return random.randint(10, 30)

    def reset_defense(self):# —Å–±—Ä–æ—Å –∑–∞—â–∏—Ç—ã
        self._is_defending = False

    def is_defending(self) -> bool:# –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞—â–∏—Ç—ã
        return self._is_defending
# —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
    def __str__(self) -> str:# —Å—Ç–∞—Ç—É—Å –≤–æ–∏–Ω–∞ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        status = ""
        if self.health <= 10:
            status = " [–ù–ê –ü–û–†–û–ì–ï –°–û–ë–°–¢–í–ï–ù–ù–û–ô –°–ú–ï–†–¢–ò]"
        return f"{self.name}{status}:\n\t‚Ä¢ –ó–¥–æ—Ä–æ–≤—å–µ: {self.health}\n\t‚Ä¢ –ë—Ä–æ–Ω—è: {self.armor}\n\t‚Ä¢ –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å: {self.endurance}"

class Battle:
    def __init__(self, warriors: List[Warrior]):
        if len(warriors) < 2:
            raise ValueError("–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –≤–æ–∏–Ω–∞ –¥–ª—è –±–æ—è")
        self.warriors = warriors

    def _select_actions(self) -> List[Tuple[Warrior, str]]:
        return [(warrior, random.choice(['attack', 'defend'])) for warrior in self.warriors]

    def _resolve_interaction(self, attacker: Warrior, defender: Warrior,
                             attacker_action: str, defender_action: str) -> str:
        attack_success, damage, attack_msg = attacker.attack()

        if not attack_success and '–Ω–µ –º–æ–∂–µ—Ç –∞—Ç–∞–∫–æ–≤–∞—Ç—å' in attack_msg:
            return attack_msg

        def_msg = defender.take_damage(damage, attacker_action)

        if defender_action == 'defend':
            return f"{attack_msg}: {def_msg}. {defender.name} –∑–∞—â–∏—â–∞–ª—Å—è"
        else:
            return f"{attack_msg}: {def_msg}"

    def _execute_turn(self, actions: List[Tuple[Warrior, str]]) -> List[str]:
        messages = []

        for warrior, action in actions:
            if action == 'defend':
                msg = warrior.defend()
                messages.append(msg)

        alive_warriors = self._get_alive_warriors()
        warrior_actions = {w: a for w, a in actions}

        for attacker, attacker_action in actions:
            if attacker_action != 'attack' or not attacker.is_alive():
                continue

            possible_targets = [w for w in alive_warriors if w != attacker and w.is_alive()]

            if not possible_targets:
                messages.append(f"{attacker.name} –Ω–µ –Ω–∞—à–µ–ª —Ü–µ–ª–∏ –¥–ª—è –∞—Ç–∞–∫–∏")
                continue

            defender = random.choice(possible_targets)
            defender_action = warrior_actions[defender]

            msg = self._resolve_interaction(attacker, defender, attacker_action, defender_action)
            messages.append(msg)

        return messages

    def _cleanup_defense(self):
        for warrior in self.warriors:
            warrior.reset_defense()

    def _get_alive_warriors(self) -> List[Warrior]:
        return [w for w in self.warriors if w.is_alive()]

    def run(self):
        turn = 1

        print("üöÄ ‚öî üöÄ \n–ù–∞—á–∞–ª–æ –±–æ—è!")
        for warrior in self.warriors:
            print(f"‚ûï {warrior}")

        while len(self._get_alive_warriors()) > 1:
            print(f"\n\n------ –•–û–î #{turn} ------")

            actions = self._select_actions()
            print("‚úâ –î–ï–ô–°–¢–í–ò–Ø:\n")
            for warrior, action in actions:
                print(f"‚Äî {warrior.name}: {action.capitalize()}")

            messages = self._execute_turn(actions)
            print("\nüî• –†–ï–ó–£–õ–¨–¢–ê–¢–´ –≠–¢–û–ì–û –•–û–î–ê:\n")
            for msg in messages:
                print(f"‚Äî {msg}")

            print("\nüìã –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –í–û–ò–ù–û–í:\n")
            for warrior in self.warriors:
                if warrior.is_alive():
                    print(f"‚òò {warrior}")
                else:
                    print(f"‚ú® {warrior.name} —Ä–∞–Ω–µ–Ω")

            self._cleanup_defense()
            turn += 1

        alive = self._get_alive_warriors()
        dead = [w for w in self.warriors if not w.is_alive()]

        if alive and dead:
            winner = alive[0]
            loser = dead[0]
            print(f"\nü•ä {loser.name.upper()} –ø—Ä–æ–∏–≥—Ä–∞–ª (–µ–≥–æ –∑–¥–æ—Ä–æ–≤—å–µ —É–ø–∞–ª–æ –Ω–∏–∂–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–π –Ω–æ—Ä–º—ã)! ‚¨á")

            # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤—ã–±–æ—Ä —É–±–∏–π—Å—Ç–≤–∞
            while True:
                choice = input("–•–æ—Ç–∏—Ç–µ –∫–∞–∑–Ω–∏—Ç—å –ø—Ä–æ–∏–≥—Ä–∞–≤—à–µ–≥–æ? (1 ‚Äî –î–∞ / 2 ‚Äî –ù–µ—Ç): ").strip()
                if choice == "1":
                    print(f"üî´ {loser.name.upper()} –±—ã–ª –∫–∞–∑–Ω—ë–Ω –ø–æ –≤–æ–ª–µ —Ç–æ–ª–ø—ã!")
                    break
                elif choice == "2":
                    print(f"üåü {loser.name.upper()} –ø–æ–º–∏–ª–æ–≤–∞–Ω –∑—Ä–∏—Ç–µ–ª—è–º–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∂–∏—Ç—å!")
                    break
                else:
                    print("–í–≤–µ–¥–∏—Ç–µ 1 –∏–ª–∏ 2.")

            print(f"ü•à –ü–û–ë–ï–î–ò–õ: {winner.name.upper()}!")
        else:
            print("üåµ –ë–æ–π –∑–∞–≤–µ—Ä—à—ë–Ω –≤–Ω–∏—á—å—é!")

if __name__ == "__main__":
    warrior1 = Warrior("–ê—Ö–∏–ª–ª–µ—Å", health=120, armor=80)
    warrior2 = Warrior("–ì–µ–∫—Ç–æ—Ä", endurance=120)

    battle = Battle([warrior1, warrior2])
    battle.run()




